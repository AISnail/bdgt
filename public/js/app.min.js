function StackedBarChart(t,a){this.element=t,this.label=a,this.data={labels:[],datasets:[{label:"",backgroundColor:"",data:[]}]}}function PieChart(t,a){this.element=t,this.label=a,this.data={labels:[],datasets:[{data:[],backgroundColor:[]}]}}jQuery(function(t){var a=function(){t(".moment").not(".processed-ready").each(function(a){var e=moment(t(this).text(),"YYYY-MM-DD").fromNow();"Invalid date"!==e&&t(this).text(e),t(this).addClass("processed-ready")})},e=function(){t(".money").not(".processed-ready").each(function(a){var e=accounting.formatMoney(t(this).text(),"$ ");void 0!==e&&t(this).text(e)})},n=function(){t(".money-signed").not(".processed-ready").each(function(a){"-"==t(this).text().charAt(0)?t(this).addClass("negative"):t(this).addClass("positive")})};a(),e(),n(),t(document).on("ajaxComplete",function(){a(),e(),n()}),t(".datepicker").each(function(){var a=t(this);a.datepicker({zIndexOffset:1050,format:"yyyy-mm-dd"}),a.val()||a.datepicker("setDate",new Date).datepicker("update")})});var Loan=function(t,a,e){this.amount=parseFloat(t),this.interestRate=parseFloat(a),this.interestRate>1&&(this.interestRate/=100),this.minimumPayment=parseFloat(e),this.payment=this.minimumPayment};Loan.prototype.makePayment=function(t){return this.payment=t,this.calculate()},Loan.prototype.getPrincipal=function(){return void 0===this.amount||NaN===this.amount?0:this.amount},Loan.prototype.calculate=function(){for(var t=0,a=this.getPrincipal(),e=0,n=moment(),o=a;o>0;)if(n.add(1,"M"),o-=this.payment,o*=1+this.interestRate,e+=o*this.interestRate,t>960||o>=1/0)return{interest:-1};return{date:n,interest:e}},Loan.prototype.formatWithCommas=function(t){return t.toString().replace(/(\.\d{2})\d+$/,"$1").replace(/(?=(\d{3})+(?!\d))/g,",")},StackedBarChart.prototype.initializeChart=function(){return this.chart=new Chart(this.element,{type:"bar",data:this.data,options:{title:{display:!0,text:this.label},tooltips:{mode:"label",callbacks:{label:function(t,a){return a.datasets[t.datasetIndex].label+": $"+t.yLabel.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}},responsive:!0,scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{callback:function(t){return"$"+t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}}]}}}),this},StackedBarChart.prototype.updateData=function(t){var a=this;a.data=t;var e=a.getSemiRandomColors();$.each(a.data.datasets,function(t,a){var n=Math.floor(Math.random()*e.length);a.backgroundColor=e[n],e.splice(n,1)})},StackedBarChart.prototype.redraw=function(){void 0!==this.chart&&this.chart.clear(),this.initializeChart()},StackedBarChart.prototype.getSemiRandomColors=function(){return["#4D4D4D","#5DA5DA","#FAA43A","#60BD68","#F17CB0","#B2912F","#B276B2","#DECF3F","#F15854"]},StackedBarChart.prototype.randomColor=function(){return Math.round(255*Math.random())},PieChart.prototype.initializeChart=function(){return this.chart=new Chart(this.element,{type:"pie",data:this.data,options:{title:{display:!0,text:this.label+" (This Month)"},tooltips:{mode:"label",callbacks:{label:function(t,a){return a.labels[t.index]+": $"+a.datasets[t.datasetIndex].data[t.index].toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}},responsive:!0}}),this},PieChart.prototype.updateData=function(t){var a=this;a.data=t;var e=a.getSemiRandomColors();$.each(a.data.datasets,function(t,a){var n=[];$.each(a.data,function(t,a){var o=Math.floor(Math.random()*e.length);n.push(e[o]),e.splice(o,1)}),a.backgroundColor=n})},PieChart.prototype.redraw=function(){void 0!==this.chart&&this.chart.clear(),this.initializeChart()},PieChart.prototype.getSemiRandomColors=function(){return["#4D4D4D","#5DA5DA","#FAA43A","#60BD68","#F17CB0","#B2912F","#B276B2","#DECF3F","#F15854"]},PieChart.prototype.randomColor=function(){return Math.round(255*Math.random())},window.onload=function(){var t=$("#bdgtReport").data("name"),a=$("#bdgtReport").data("url");void 0!==a&&("Spending By Category"===t?window.bdgtReport=new PieChart($("#bdgtReport")[0],t):window.bdgtReport=new StackedBarChart($("#bdgtReport"),t),$.getJSON(a,function(t){window.bdgtReport.updateData(t),window.bdgtReport.redraw()}))};